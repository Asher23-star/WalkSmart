<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="wordless.png" type="image/png">
    <style>
      .textbox {
        width: 60%;
        height: 60px;
        border: 1px solid #ccc;
        padding-left: 10px;
        font-size: 15px;
        margin-left: 90px;
      }
      label {
        margin-left: 90px;
      }
      .login:hover {
        background-color: #240505;
        transform: scale(1.05);
      }
      .container2 {
        display: flex;
        justify-content: center;
        align-items: center;
      }
    </style>
  </head>
  <body
    style="
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      margin: 0;
      background-color: white;
    "
  >
     <header class="header">
    <a href="index.html">
      <img src="Walk Smart.png" alt="Logo" class="logo">
    </a>
    <nav class="nav-links">
      <a href="home.html">Home</a>
      <a href="product.html">Products</a>
      <a href="Dashboard.html">Dashboard</a>
      <a href="index.html" class="logout">Log out</a>
    </nav>
  </header>
        
    <br /><br />
    <div class="container2">
      <form
        id="loginForm"
        method="post"
        onsubmit="return validateLogin(event)"
        style="justify-content: center"
      >
        <h1 style="font-size: 40px">Login to Your Account</h1>
        <br />

        <!-- TRN Input -->
        <label>TRN</label><br /><br />
        <input
          type="text"
          id="trn"
          class="textbox"
          placeholder="Enter your TRN"
          required
          pattern="\d{9}"
        /><br /><br />

        <!-- Password Input -->
        <label>Password</label><br /><br />
        <input
          type="password"
          id="password"
          class="textbox"
          placeholder="Enter your password"
          required
          minlength="8"
        /><br /><br />

        <!-- Submit and Register buttons -->
        <input
          type="submit"
          value="Log in"
          class="login"
          style="
            background-color: #ff3131;
            padding: 20px 50px;
            border-radius: 5px;
            color: white;
            border: none;
            cursor: pointer;
            margin-left: 170px;
          "
        />

        <!-- Register Button -->
        <button
          type="button"
          onclick="window.location.href='registration.html'"
          style="
            background-color: #ff3131;
            padding: 20px 50px;
            border-radius: 5px;
            color: white;
            border: none;
            cursor: pointer;
          "
        >
          Register
        </button>
      </form>
    </div>

    <script>
      let loginAttempts = 0;

      function validateLogin(event) {
  event.preventDefault();

  const trn_input = document.getElementById("trn").value.trim();
  const password_input = document.getElementById("password").value.trim();

  // Retrieve registration data from localStorage
  const registrationData = JSON.parse(localStorage.getItem("RegistrationData")) || [];

  // Check if the entered TRN and password match any stored user data
  const user = registrationData.find((user) => user.idnum === trn_input && user.pass === password_input);

  if (user) {
    // Successful login, redirect to home page
    window.location.href = "home.html";

    // Store TRN in localStorage for session use
    localStorage.setItem("LoggedInUserTRN", JSON.stringify(trn_input));

    // Optionally, you could store other session-related data here if needed.
  } else {
    loginAttempts++;

    if (loginAttempts >= 3) {
      window.location.href = "error.html"; // Redirect after too many attempts
    } else {
      alert(`Invalid login. You have ${3 - loginAttempts} attempt(s) left.`);
      document.getElementById("loginForm").reset(); // Clear input fields on failure
    }
  }
}


      document
        .getElementById("loginForm")
        .addEventListener("submit", validateLogin);
    </script>

    <footer>
      <div>
        <h1>Store Locations</h1>
        <ul style="list-style-type: none; text-align: left">
          <li>Walk Smart Mandeville</li>
          <br />
          <li>Walk Smart Kingston</li>
          <br />
          <li>Walk Smart Falmouth</li>
          <br />
          <li>Walk Smart Montego Bay</li>
          <br />
          <li>Walk Smart Spanish Town</li>
        </ul>
      </div>

      <div style="margin-left: 1000px">
        <h1>Get in Touch</h1>
        <p>
          1-876-553-2950 â€¢ Contact Us<br /><br />Mon to Sat: 9am-6pm (EST)<br />Sun:
          Closed
        </p>
      </div>
    </footer>
  </body>
</html>
